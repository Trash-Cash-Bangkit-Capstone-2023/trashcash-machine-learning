# -*- coding: utf-8 -*-
"""prepare_dataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/10yN5cN_xIlTOQ-8JweEXbOFRtmdd3SJn
"""

import os
import zipfile
import shutil

# Unduh dataset dari Kaggle dan unggah ke Google Colab
!pip install -q kaggle
os.environ['KAGGLE_USERNAME'] = 'rezaldi'
os.environ['KAGGLE_KEY'] = '8cf4e8b9dbf3749ff34c10459a53a6f4'
!kaggle datasets download -d alexfordna/garbage-seg-10-v5
# Ekstrak file zip
with zipfile.ZipFile('/content/garbage-seg-10-v5.zip', 'r') as zip_ref:
    zip_ref.extractall('/content/dataset')

# Buat folder untuk train, validation, dan test
base_dir = '/content/dataset'
os.makedirs(base_dir, exist_ok=True)

train_dir = os.path.join(base_dir, 'train')
os.makedirs(train_dir, exist_ok=True)

validation_dir = os.path.join(base_dir, 'validation')
os.makedirs(validation_dir, exist_ok=True)

test_dir = os.path.join(base_dir, 'test')
os.makedirs(test_dir, exist_ok=True)

# Kategori sampah yang bisa dijual (sellable)
sellable_categories = ['battery', 'cardboard', 'clothes', 'glass', 'metal', 'paper', 'plastic', 'shoes']
# Kategori sampah yang tidak bisa dijual (unsellable)
unsellable_categories = ['food', 'medical']

# Memindahkan gambar ke folder yang sesuai
for category in sellable_categories:
    category_train_dir = os.path.join(train_dir, 'sellable', category)
    os.makedirs(category_train_dir, exist_ok=True)

    images_dir = os.path.join('/content/dataset/Garbage Seg 10 V5/', category)
    images = os.listdir(images_dir)

    for image in images:
        src_path = os.path.join(images_dir, image)
        dst_path = os.path.join(category_train_dir, image)
        shutil.copy(src_path, dst_path)

for category in unsellable_categories:
    category_train_dir = os.path.join(train_dir, 'unsellable', category)
    os.makedirs(category_train_dir, exist_ok=True)

    images_dir = os.path.join('/content/dataset/Garbage Seg 10 V5/', category)
    images = os.listdir(images_dir)

    for image in images:
        src_path = os.path.join(images_dir, image)
        dst_path = os.path.join(category_train_dir, image)
        shutil.copy(src_path, dst_path)
